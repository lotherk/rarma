<% @classes.each do |c| -%>
  <%- if c.inherit -%>
CLASS_EXTEND("<%= c -%>", "<%= c.inherit %>")
<%   else -%>
CLASS("<%= c -%>")
<%   end -%>
<%-%>
<%  c.vars.each do |v| -%>
        PRIVATE VARIABLE("any", "@<%= v[:name] -%>");
<%    if v[:access] == :accessor or v[:access] == :reader -%>
        PUBLIC FUNCTION("", "<%= v[:name] -%>") FUNC_GETVAR("@<%= v[:name] -%>");
<%    end -%>
<%    if v[:access] == :accessor or v[:access] == :writer -%>
        PUBLIC FUNCTION("any", "<%= v[:name] -%>=") { MEMBER("@<%= v[:name] -%>", _this); };
        PUBLIC FUNCTION("any", "set_<%= v[:name] -%>") { MEMBER("@<%= v[:name] -%>", _this); }
<%    end -%>
<%  end -%>
<%   c.meths.each do |m| -%>
    <%= m[:sig].upcase -%> FUNCTION("<%= m[:type].downcase -%>", "<%= m[:name] -%>") {
<%     if m[:args].count == 1 -%>
<%       if m[:args][0][0] =~/^_/ -%>
        private "<%= m[:args][0][0] -%>";
<%       end -%>
        <%= m[:args][0][0] -%> = RPARAM(<%= m[:args][0][1] -%>);
<%     else -%>
<%       m[:args].each_with_index do |a,i| -%>
<%         if a[0] =~/^_/ -%>
        private "<%= a[0] -%>";
        <%= a[1] -%> = RPARAMS(<%= i -%>, <%= a[1] -%>);
<%         end -%>
<%       end -%>
<%     end -%>
<%     m[:body].each do |b| -%>
        <%= b.chomp %>
<%     end -%>
    };
<%   end -%>
ENDCLASS;
<% end %>
